%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Beamer Presentation
% LaTeX Template
% Version 1.0 (10/11/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND THEMES
%----------------------------------------------------------------------------------------
%!TEX encoding = UTF-8 Unicode


\documentclass[12pt,handout]{beamer}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage[T1]{fontenc}
\usepackage{verbatim}

\mode<presentation> {

\usetheme{Pittsburgh}

}

\usepackage{graphicx} % Allows including images
\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables

%----------------------------------------------------------------------------------------
%	TITLE PAGE
%----------------------------------------------------------------------------------------

\title[]{Critical behaviour of the surface tension in the 3D Ising model} % The short title appears at the bottom of every slide, the full title is only on the title page

\author[]
{
Federico Belliardo \\
Marco Costa
} 

\institute[] % Your institution as it will appear on the bottom of every slide, may be shorthand to save space
{
Dipartimento di Fisica\\ % Your institution for the title page
Università di Pisa \\
\medskip
}
\date{\today} % Date, can be changed to a custom date

\begin{document}

\begin{frame}
\titlepage % Print the title page as the first slide
\end{frame}

%\begin{frame}
%\frametitle{Overview} % Table of contents slide, comment this block out to remove it
%\quadleofcontents % Throughout your presentation, if you choose to use \section{} and \subsection{} commands, these will automatically be printed on this slide as an overview of your presentation
%\end{frame}

%----------------------------------------------------------------------------------------
%	PRESENTATION SLIDES
%----------------------------------------------------------------------------------------

\begin{frame}{Summary}

\begin{center}

\begin{itemize}
\item 3D Ising models
\item Definition of the surface tension
\item Cluster algorithms and boundary flip
\item (Notes on the implementation?)
\item Estimation of the errors and autocorrelation
\item Fit of the free energy
\item Fit of the critical behaviour
\item (Conclusion?)
\end{itemize}

\end{center}
\end{frame}

\begin{frame}{3D Ising model}
\begin{center}
\begin{columns}
\begin{column}{0.43\textwidth}
 \[
\mathcal{H} = -\sum_{\langle x, y \rangle} J_{\langle x, y \rangle} s_x s_y
\]

\[
J_{\langle x, y \rangle} = 1\text{ ferromagnetic}
\]
\[
J_{\langle x, y \rangle} = -1\text{ antiferromagnetic}
\]
\end{column}

\begin{column}{0.57\textwidth}  %%<--- here
 \begin{figure}[!htb]
\centering
\includegraphics[scale=0.5]{ising3D.png}
\end{figure}
\end{column}
\end{columns}


\end{center}
\end{frame}

\begin{frame}{Definition of the surface tension}
\begin{center}


\begin{figure}[!htb]
\centering
\includegraphics[scale=0.5]{bound.png}
\end{figure}

\vspace{20pt}

{\Large
$
\sigma = -\lim_{L \rightarrow \infty} \frac{1}{L^2} \log \frac{Z_{+-}}{Z_{++}}$} $ \quad L \times L \times T,\, T = cL$

\note{L'ordine dei due limiti T e  non dovrebbe contare. Non so se si può "dimostrare" al nostro libello di rigore fisiamo T = 3L e facciamo il limite per L. Per sistemare la faccenda introduciamo una larghezza L del sistema e questa è l'unica lunghezza che va all'infinito.}

\note{$Z_{+-}$ e $Z_{++}$ sono le funzioni di partzione quando fisso cosa devono valere i layer di spin sul pavimento e sul soffito. Inserire piccola immagine per spiegarlo.}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
\begin{figure}[!htb]
\centering
\includegraphics[scale=0.50]{comparison.png}
\end{figure}
\[
\sigma = -\lim_{L \rightarrow \infty} \frac{1}{L^2} \log \frac{Z_{+-}}{Z_{++}} = \lim_{L \rightarrow \infty} \frac{1}{L^2} \left( F_{+-} - F_{++} \right) = \lim_{L \rightarrow \infty} \frac{F_s}{L^2}
\]
\[\sigma = \text{interface free energy per unit area}\]

\note{Bisogna dire che nel limite termodinamico sopravvive una sola superficie di separazione.}

\end{center}
\end{frame}

\begin{frame}
\begin{center}

\begin{columns}
\begin{column}{0.50\textwidth}
\begin{center}
Redefinition of $Z_{++}$ and $Z_{+-}$.\\
\vspace{10pt}
$Z_{++} \rightarrow $ ferromagnetic link between \textbf{top and bottom}.\\
$Z_{+-} \rightarrow $ \textbf{anti}ferromagnetic link between \textbf{top and bottom}.\\
\vspace{10pt}
Always ferromagnetic link in $x$ and $y$ directions.\\
\vspace{10pt}
Same definition for $\sigma$.\\
\vspace{10pt}
Periodic boundary conditions reduce the finite size effect.\\
\end{center}

\end{column}
\begin{column}{0.50\textwidth}

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.6]{antiferro.png}
\end{figure}

\end{column}
\end{columns}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
{\Large Montecarlo simulations can't measure $Z$!\\}
\vspace{10pt}
Solution: $J_{\langle x, y \rangle}$ between top and bottom becomes a \textbf{dinamical variable} that is summed over in $Z$.\\
$J_{\langle x, y \rangle} = 1$ (periodic b.c.)\hspace{10pt}$J_{\langle x, y \rangle} = -1$ (antiperiodic b.c.)\\
Other $J_{\langle x, y \rangle}$ remains ferromagnetic.
\[
Z = \sum_{\lbrace s \rbrace, J} \exp \left( \beta \sum_{\langle x, y \rangle} J_{\langle x, y \rangle} s_x s_y \right)
\]

{\large \[
\frac{Z_{+-}}{Z_{++}} = \frac{\frac{Z_{+-}}{Z}}{\frac{Z_{++}}{Z}}=\frac{\langle \delta_{J = -1} \rangle}{\langle \delta_{J = + 1} \rangle}
\]}

Ratio of measurable expectation values.
\end{center}
\end{frame}

\begin{frame}
\begin{center}
We redefine the free energy of the interface in order to improve the convergence proprieties of $\frac{F_s}{L^2}$ to $\sigma$ when $L \rightarrow \infty$.\\
\vspace{10pt}
Thermodynamic limit {\Large $\rightarrow$} only \textbf{one} interface\\
For finite $L$ multiple interface can be present. An even number for $Z_{++}$ and odd for $Z_{+-}$.\\

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.3]{multiple.png}
\end{figure}

\end{center}
\end{frame}

\begin{frame}
\begin{center}

$F_s$ is the free energy of a single surface. There are $\sim T$ different position for the interface.

\[Z_1 = T \exp \left( - F_s \right) = \exp \left( -F_S +\ln T \right) \]

\[ \frac{Z_{+-}}{Z_{++}} = \frac{Z_1 + \frac{Z_1^3}{3!} + \frac{Z_1^3}{5!} + ...}{1 +  \frac{Z_1^2}{2!} + \frac{Z_1^4}{4!} + ...} = \tanh \left( \exp \left( -F_S +\ln T \right) \right) \]

\[
F_S = \ln \left( T \right) - \ln \left( \frac{1}{2} \ln \left( \frac{1 + \frac{Z_{+-}}{Z_{++}}}{1 - \frac{Z_{+-}}{Z_{++}}} \right) \right) \quad \sigma = \lim_{L \rightarrow \infty} \frac{F_s}{L^2} \]


\end{center}
\end{frame}

\begin{frame}{Cluster algorithms and boundary flip}
\begin{center}

Cluster algorithms allow for simultaneous updates of large parts of the lattice. Thus reducing the autocorrelation time and the critical slowling down. Swendsen and Wang (1987).\\
\vspace{10pt}
Introduce link variables $\sigma_{\langle x, y \rangle} = \lbrace 0, 1 \rbrace$ on the lattice:

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.4]{link.png}
\end{figure}

\note{Giustificare perché metto tre reticoli. Sono a diversa temperatura. A bassa T (alto beta) è facile formare i cluster. A basso beta è difficile.}

\end{center}
\end{frame}

\begin{frame}
\begin{center}

\begin{gather*}
Z = \sum_{\lbrace s = \pm 1\rbrace} \exp \left( \beta \sum_{\langle x, y \rangle} s_x s_y \right) = \sum_{\lbrace s = \pm 1 \rbrace} \prod_{\langle x, y \rangle} e^{ \beta  s_x s_y} = \\[20pt]
= e ^{ -d V \beta } \sum_{\lbrace s = \pm 1 \rbrace} \prod_{\langle x, y \rangle} \left( 1 + \delta_{s_x, s_y} \left( e^{  2 \beta} - 1 \right) \right) = \\[20pt]
= e^{ -d V \beta} \sum_{\lbrace s \rbrace} \prod_{\langle x, y \rangle}   \sum_{\lbrace \sigma_{\langle x, y \rangle} = 0,1 \rbrace} \left[ \left( 1 - \sigma_{\langle x, y \rangle} \right)
+ \sigma_{\langle x, y \rangle} \delta_{s_x, s_y} \left( e^{ 2 \beta } - 1 \right) \right]
\end{gather*}

\end{center}
\end{frame}

\begin{frame}
\begin{center}

Also valid for generic coupling $J_{\langle x, y \rangle}$:

\begin{gather*}
Z = \sum_{\lbrace s = \pm 1\rbrace} \exp \left( \beta \sum_{\langle x, y \rangle} J_{\langle x, y \rangle} s_x s_y \right) = \sum_{\lbrace s = \pm 1 \rbrace} \prod_{\langle x, y \rangle} e^{ \beta  J_{\langle x, y \rangle} s_x s_y} = \\[20pt]
= e ^{ -d V \beta } \sum_{\lbrace s = \pm 1 \rbrace} \prod_{\langle x, y \rangle} \left( 1 + \delta_{J_{\langle x, y \rangle} s_x s_y, 1} \left( e^{  2 \beta} - 1 \right) \right) = \\[20pt]
= e^{ -d V \beta} \sum_{\lbrace s \rbrace} \prod_{\langle x, y \rangle}   \sum_{\lbrace \sigma_{\langle x, y \rangle} = 0,1 \rbrace}  \left( 1 - \sigma_{\langle x, y \rangle} \right) + \\
+ \sigma_{\langle x, y \rangle} \delta_{J_{\langle x, y \rangle} s_x s_y, 1} \left( e^{ 2 \beta } - 1 \right) 
\end{gather*}

\end{center}
\end{frame}

\begin{frame}
\begin{center}

For a fixed spin configuration $\lbrace s \rbrace$ the links are independent.
\[
p_0 = p \left( \sigma_{\langle x, y \rangle} = 0 \right)  = \exp \left( - 2 \beta \delta_{J_{\langle x, y \rangle} s_x s_y, 1} \right)
\]
\[
p_1 = p \left( \sigma_{\langle x, y \rangle} = 1 \right) = 1 - p \left( \sigma_{\langle x, y \rangle} = 1 \right)
\]

(if $J_{\langle x, y \rangle} s_x s_y = 1$ the weights in $Z$ are normalized to $e^{2 \beta}$)\\
\vspace{30pt}
For simplicity let's put $J_{\langle x, y \rangle} = 1$. For fixed $\sigma_{\langle x, y \rangle}$ only
configurations of spins that satisfy the constraint $s_x = s_y$ where $\sigma_{\langle x, y \rangle} = 1$ have a non zero probability. All configurations of spin that satisfy the constraint have the same weight.

\end{center}
\end{frame}

\begin{frame}
\begin{center}

Definition: a \textbf{cluster} is a set of spins in the lattice path-connected by links with $\sigma_{\langle x, y \rangle} = 1$. If $J_{\langle x, y \rangle} = 1$ all sites of a cluster are forced to have the same spin.

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.5]{esempioCluster.png}
\end{figure}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
{\Large Swendsen and Wang algorithm:}

\begin{itemize}
\item Generate a link configuration $\sigma_{\langle x, y \rangle}$ based on the current spin configuration by using probablities $p_0$ and $p_1$. 
\item For each cluster choose a spin $\left( s = \pm 1 \right)$ with probability $\frac{1}{2}$. In general the updte step must be compatible with the constraint $J_{\langle x, y \rangle}  s_x s_y = 1$.
\item The newly generted spin configuration is the next element of the Markov chain.
\end{itemize}

\vspace{20pt}
The SW is \textbf{ergodic}. We know prove that it satisfies the \textbf{detailed balance}.

\end{center}
\end{frame}

\begin{frame}
\begin{center}
In the cluster algorithm we update both the spins $\lbrace s \rbrace$ and the links $\lbrace \sigma_{x, y} \rbrace$. The ensamble contains both spin and link configurations: $\lbrace s,  \sigma \rbrace$.

\[
\frac{P \left( \lbrace s_0, \sigma_0 \rbrace \rightarrow \lbrace s_1, \sigma \rbrace \right)}{ P \left( \lbrace s_1, \sigma_0 \rbrace \rightarrow \lbrace s_0, \sigma \rbrace \right)} = \frac{P \left( \lbrace s_1 \rbrace | \lbrace \sigma, s_0 \rbrace \right) P \left( \lbrace \sigma \rbrace | \lbrace s_0 \rbrace \right) }{ P \left( \lbrace s_0 \rbrace | \lbrace \sigma, s_1 \rbrace \right) P \left( \lbrace \sigma \rbrace | \lbrace s_1 \rbrace \right) }
\]

(this is not the detailed balance in the ensamble of $\lbrace s,  \sigma \rbrace$ as the link configurations don't get exchanged!)


\end{center}
\end{frame}


\begin{frame}
\begin{center}

$P \left( \lbrace s \rbrace | \lbrace \sigma, s_0 \rbrace \right) =
 \frac{1}{2^{\# cluster}}$ if $\lbrace s \rbrace$ is compatible with $\lbrace \sigma \rbrace$, null otherwise. Notice that in thw SW algorithm $\lbrace s \rbrace$ is actually independent on $\lbrace s_0 \rbrace$.\\
\vspace{20pt} 
Thus {\large $P \left( \lbrace s_1 \rbrace | \lbrace \sigma, s_0 \rbrace \right) = P \left( \lbrace s_0 \rbrace | \lbrace \sigma, s_1 \rbrace \right)$}.\\
\vspace{20pt}
In general this is the condition we ask to cluster algorithms.

%In effetti questa probabilità non mi convince - rivedere.

%Dire che in realtà noi usiamo il sigle cluster algorithm con un procedimento ricorsivo (implementato con uno stack) che controlla una ed una sola volta ogni link per vedere se attivarlo o meno. Costruendo così un singolo cluster che andiamo a flippare.


\end{center}
\end{frame}

\begin{frame}
\begin{center}

{\large
\[P \left( \lbrace \sigma \rbrace | \lbrace s \rbrace \right) =
\prod_{ \substack{ \sigma_{\langle x, y \rangle} = 0 \\ J_{\langle x, y \rangle} s_x s_y = 1}} e^{-2 \beta} \prod_{\sigma_{\langle x, y \rangle} = 1} \left( 1- e^{-2 \beta } \right)
\]} for $\lbrace s \rbrace$ compatible with $\lbrace \sigma \rbrace$.\\
\vspace{20pt}
The first factor arise from the unconnected links for which $J_{\langle x, y \rangle} s_x s_y = 1$ each being in this state with probability $e^{ - 2 \beta }$. The second one is from the connected links (for which $J_{\langle x, y \rangle} s_x s_y = 1$ necessarily).\\
\vspace{20pt}
The second factor is \textbf{independent of $\lbrace s \rbrace$} and will be neglettend in the sequent.

\end{center}
\end{frame}

\begin{frame}
\begin{center}

We obtain:

\[
P \left( \lbrace \sigma \rbrace | \lbrace s \rbrace \right) =
\prod_{ \substack{ \sigma_{\langle x, y \rangle} = 0 \\ J_{\langle x, y \rangle} s_x s_y = 1}} e^{-2 \beta}
\]

Now we compute (reminding $\lbrace s_0 \rbrace$ and $\lbrace s_1 \rbrace$ share the same $\lbrace \sigma \rbrace$):

\begin{gather*}
\frac{e^{- \beta \mathcal{H} \left( \lbrace s_1 \rbrace \right)}}{e^{- \beta \mathcal{H} \left( \lbrace s_0 \rbrace \right)}} = \frac{\prod_{\langle x, y \rangle} e^{J_{\langle x, y \rangle} s^1_x s^1_y}}{\prod_{\langle x, y \rangle} e^{J_{\langle x, y \rangle} s^0_x s^0_y}} = \\ \frac{\prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = +1}} e^{\beta} \prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = -1}} e^{-\beta} \prod_{\substack{\sigma = 1 \\ J s^1_x s^1_y = +1}} e^{\beta}}{\prod_{\substack{\sigma = 0 \\ J s^0_x s^0_y = +1}} e^{\beta} \prod_{\substack{\sigma = 0 \\ J s^0_x s^0_y = -1}} e^{-\beta} \prod_{\substack{\sigma = 1 \\ J s^0_x s^0_y = +1}} e^{\beta}}
\end{gather*}

The last part having $\sigma = 1$ obviously depends only on $\lbrace \sigma \rbrace$ for all $J_{\langle x, y \rangle} s_x s_y$ beeing forced to $1$ if $\sigma=1$.

\end{center}
\end{frame}

\begin{frame}
\begin{center}
We observe that: 
\[
\prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = -1}} e^{-\beta} \times \prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = 1}} e^{-\beta} = \prod_{\sigma = 0} e^{-\beta} = k
\] $k$ depends only on the link configuration $\lbrace \sigma \rbrace$\\

\[
\prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = -1}} e^{-\beta} = k \prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = 1}} e^{\beta} 
\]

\[
\frac{e^{- \beta \mathcal{H} \left( \lbrace s_1 \rbrace \right)}}{e^{- \beta \mathcal{H} \left( \lbrace s_0 \rbrace \right)}} = \frac{\prod_{\substack{\sigma = 0 \\ J s^1_x s^1_y = +1}} e^{2 \beta}} { \prod_{\substack{\sigma = 0 \\ J s^0_x s^0_y = +1}} e^{2 \beta}} = \frac{\prod_{\substack{\sigma = 0 \\ J s^0_x s^0_y = +1}} e^{-2 \beta}} { \prod_{\substack{\sigma = 0 \\ J s^1s_x s^0_y = +1}} e^{-2 \beta}}
\]

\end{center}
\end{frame}


\begin{frame}
\begin{center}

We arrived at:

\[
\frac{P \left( \lbrace s_0, \sigma_0 \rbrace \rightarrow \lbrace s_1, \sigma \rbrace \right)}{ P \left( \lbrace s_1, \sigma_0 \rbrace \rightarrow \lbrace s_0, \sigma \rbrace \right)} = \frac{e^{- \beta \mathcal{H} \left( \lbrace s_1 \rbrace \right)}}{e^{- \beta \mathcal{H} \left( \lbrace s_0 \rbrace \right)}}
\]

\[
P \left( \lbrace s_0 \rbrace \rightarrow \lbrace s_1\rbrace \right) = \sum_{\lbrace \sigma \rbrace, \lbrace \sigma_0 \rbrace} P \left( \lbrace s_0, \sigma_0 \rbrace \rightarrow \lbrace s_1, \sigma \rbrace \right)
\]

We thus obtain the detailed balance:

{ \Large
\[
\frac{P \left( \lbrace s_0 \rbrace \rightarrow \lbrace s_1\rbrace \right)}{P \left( \lbrace s_1 \rbrace \rightarrow \lbrace s_0\rbrace \right)} = \frac{e^{- \beta \mathcal{H} \left( \lbrace s_1 \rbrace \right)}}{e^{- \beta \mathcal{H} \left( \lbrace s_0 \rbrace \right)}}
\]
}

\end{center}
\end{frame}

\begin{frame}
\begin{center}

{\large
\begin{itemize}

\item The only requirement on the update step is that  $P \left( \lbrace s_1 \rbrace | \lbrace \sigma, s_0 \rbrace \right) = P \left( \lbrace s_0 \rbrace | \lbrace \sigma, s_1 \rbrace \right)$.
\item We can also update the coupling constants $J_{\langle x, y \rangle}$ as long as $J_{\langle x, y \rangle} s_x s_y = 1$ where $\sigma = 1$.

\end{itemize}}

\vspace{30pt}

This two observations give rise to two key modification of the SW algorithm: the Wolff algorithm and the boundary flip.

\end{center}
\end{frame}

\begin{frame}
\begin{center}
{
\Large Single cluster update (Wolff):\\
}
\vspace{10pt}
In the Wolff algorithm we choose at random one site of the lattice and flip the cluster it belongs to. The probability of going from $s_1$ to $s_0$ ad viceversa is obviously the same, beeing the probability of choosing the right cluster. Notice that $P \left( \lbrace s \rbrace | \lbrace \sigma \rbrace \right) \neq$ const. Practically we build only \textbf{one cluster} starting from a seed.\\

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.4]{wolff.png}
\end{figure}

%TODO--Questa cosa non mi torna: "we chose at random one site of the lattice" or "we chose at random a cluster".

\end{center}
\end{frame}

\begin{frame}
\begin{center}

{\Large Boundary flip algorithm:\\}
\vspace{20pt}
$J = 1$ in the bulk, but the coupling between the top and the bottom is now a dynamical variable to simulate: $\lbrace s, \sigma, J_{0, T-1} = \pm 1 \rbrace$ is ana element of the ensamble.\\
\vspace{20pt}
A link $\sigma_{\langle 0, T-1 \rangle} = 1$ demands $J_{0, T-1} s_0 s_{T-1} = 1$. Thus we can flip $J_{0, T-1}$, $s_0$ and all the spins connected to $s_0$ via some chain of links in the bulk obtaing a configuration compatible with $\lbrace \sigma_{\langle x, y \rangle} \rbrace $. This for all the spins on the bottom boundary.

\end{center}
\end{frame}

\begin{frame}
\begin{center}
\begin{columns}
\begin{column}{0.20\textwidth}
\begin{center}
Boundary condition update.
Section of a $7 \times 7 \times 21$ lattice at temperature $\beta = 0.250$
\end{center}
\end{column}
\begin{column}{0.80\textwidth}
\begin{figure}[!htb]
\centering
\includegraphics[scale=0.5]{boundaryFlip.png}
\end{figure}

\end{column}
\end{columns}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
{ \large The boundary flip generates an interface between phases!\\ } 
\vspace{20pt}
We must check this update can be done without violating the constraints imposed by the bulk links ($\sigma_{\langle x, y \rangle} = 1$ implies $s_x = s_y$).\\
\vspace{20pt}
Check all the clusters that contain sites of the lower surface and flip the boundary condition only if it can be done consistently in all the lattice.
\end{center}
\end{frame}

\begin{frame}
\begin{center}

\begin{columns}
\begin{column}{0.30\textwidth}
\begin{center}
Introduce extra variables $c_{x} = \pm 1$ that get propagated in the bulk during the costruction of the cluster but change sign when crossing the boundary.
\end{center}
\end{column}
\begin{column}{0.70\textwidth}

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.5]{extra.png}
\end{figure}

\end{column}
\end{columns}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
%The boundary flip is ergodic
We do $N$ total steps alternating the Wolff algorithm with the boundary flip.\\
\vspace{20pt}
After each update we count if the current configuration has ferromagnetic or antiferromagnetic coupling between top and bottom.\\ 
\[
\langle \delta_{J = -1} \rangle = \frac{\# \text{Antiferromagnetic}}{N}
\]
\[
\langle \delta_{J = +1} \rangle = \frac{\# \text{Ferromagnetic}}{N}
\]

\end{center}
\end{frame}


\begin{frame}{Notes on the implementation}
\begin{center}

C++ for the Montecarlo and Jackknife algorithms, Python for data analysis, fits and plots.\\
\vspace{20pt}
The hot function of the simulation generates a cluster starting in a given position and exploring the neighbouring links. If a link is chosen to be $\sigma_{\langle x, y \rangle} = 1$ then the adjacent site is included in the cluster and the procedure is repeated. The extra variable $c_x$ is also propagated.
\end{center}
\end{frame}


\begin{frame}

stack<site> stack

stack.push(seed)

while(!stack.empty())

\quad site current = stack.top()

\quad if(cluster[current] is incostintent) flag = 1;

\quad else if(cluster[current] == 0)

\quad \quad cluster[current] = cluster[old];

\quad \quad for(d = 0; d < 3; d++) 

\quad \quad \quad for(a = -1; a < 2; a = a + 2) 

\quad \quad \quad next = current + a

\quad \quad \quad Check if we are on the boundary
				
\quad \quad \quad if(cluster[next] == 0)

\quad \quad \quad \quad if(p > 0 and random < p) stack.push(next)\\
return flag

\end{frame}

\begin{frame}{Algorithm properties: correlation}
\begin{center}
Estimate of integrated correlation time $\tau$: data blocking

\[
	\sigma_{\bar{x}}^2 = 2\tau\sigma_{x}^2/N
\]
Idea: study the fluctuation around average of block averages.
\[
	\sigma _B ^2 = \frac{1}{N_B - 1}\sum_ {i = 1} ^{N_B} \left( x_{B_i} - \bar{x} \right)^2 
\]
If $k\gg\tau$, blocks are uncorrelated and we get $\sigma_B^2/N_B = \sigma_{\bar{x}}^2$.
Asymptotically in $k$ we have:
\[
	2\tau = k \sigma_B ^2/\sigma_{x}^2
\]
\end{center}
\end{frame}


\begin{frame}
\begin{center}
\begin{figure}
\centering
\includegraphics[scale=0.4]{corrbc.png}
\caption{Integrated correlation time for boundary condition value\label{fig:corr}}
\end{figure}
$\tau \simeq 1$: low correlation time even for $\beta = 0.2391, L = 10$
%TODO metropolis correlation time
\end{center}
\end{frame}

\begin{frame}{Algorithm properties: thermalization}
Thermalization test: Kolmogorov-Smirnov
If after thermalization time $T$ the distribution of observbables is the same (2 sided KS test) system is in thermal equilibrium
\end{frame}

\begin{frame}{Estimation of the errors}
\begin{center}
We want to estimate reduced free energies $F$ at given $\beta, L$.
\[
	\hat{F}_N = \frac{\# \text{Antiferromagnetic}}{\# \text{Ferromagnetic}}
\]
$N_B$ resamples created via blocked Jackknife.

We divide initial sample in $N_B$ block with fixed length $k\gg \tau$.

$i$-th resample: all blocks except block $i$

We calculate the free energy on the resamples.
\[
	\hat{F}_{N-k, i} = \frac{\sum_ { \mbox{no block i }} \# \text{Antiferromagnetic} }{\sum_ {\mbox{no block i}} \# \text{Ferromagnetic}}
\]

\end{center}
\end{frame}

\begin{frame}{Estimation of errors}
\begin{center}
Statistical error: fluctuation around $\hat{F}_N$ evaluated on resamples.

\[
	\sigma_{F, N-k}^2 = \frac{1}{N_B-1}\sum_i ^{N_B} \left(\hat{F}_{N-k, i} - \hat{F}_N\right)^2
\]
To relate fluctuation of $N-k$-long samples to $N$-long original sample multiply to get correct sum of errors.
\[
	\sigma_{F_N}^2 = \frac{N_B-1}{N_B}\sum_i ^{N_B} \left(\hat{F}_{N-k, i} - \hat{F}_N\right)^2
\]
\end{center}
\end{frame}

\begin{frame}{Bias}
\begin{center}
By Great Numbers' Law $\hat{F}_N$ is consistent. Is it biased?
\[
	\mathbb E \left[\hat{F}_N\right] = F + \frac{\alpha_1}{N} + \frac{\alpha _2}{N} \ldots 
\]
Jackknife resamples help to construct a less biased estimator
\[
	\hat_{F}^{\left(u\right)} _N = N_B\hat{F}_N - \frac{N-k}{N} \sum_{i = 1} ^ {N_B} \hat{F}_{N-k, i}
\]
From data: bias $\ll$ statistical uncertainty

%TODO scrivi esempio di F biassato e non per far vedere che è molto piccolo
\end{center}
\end{frame}


\begin{frame}
\begin{center}
\begin{itemize}
\item The simulations were executed with $N = 10^5, 10^6$ steps of the Markov chain.\\
\vspace{10pt}
\item The first $10\%$ of the Markov chain is ignored to avoid non-termalized configurations.\\
\vspace{10pt}
\item The Jackknife is executed for blocks of size starting from $10000$ to $10900$ with step of $30$ events. \\
\item No strong dependace of results on block length.
\end{itemize}
\end{center}
\end{frame}

\begin{frame}{Capillary Wave Model}

\begin{figure}[!htb]
\centering
\includegraphics[scale=0.5]{CWM.png}
\caption{2D effective description of the interface}
\end{figure}
\begin{center}
Energy proportional to surface!
\[
	\mathcal H = \sigma\left(\beta \right) \int _0 ^{L} \mbox{d}x \int _0 ^{L} \sqrt{1 + \left(\frac{\partial h}{\partial x}\right)^2 + \left(\frac{\partial h}{\partial y}\right)^2}
\]
%\[
%	\mathcal H \sigma\left(\beta \right) \int _0 ^{L} \mbox{d}x \int _0 ^{L} 1 + \frac{1}{2}\left(\nabla{h}\right) ^2 - \frac{1}{8}\left(\left(\nabla{h}\right) ^2\right) ^2
%\]
1-Loop calculations:
\[
	F = C + \sigma L ^2 + \sigma\log\left( 1 + \frac{1}{4\sigma L^2}\right)
\]
\end{center}
\end{frame}

\begin{frame}{Fit of the free energy - results}
\begin{figure}[!htb]
\centering
\includegraphics[scale=0.4]{02255FvsL.png}
\end{figure}
\end{frame}

\begin{frame}
\begin{figure}[!htb]
\centering
\includegraphics[scale=0.4]{02391FvsL.png}
\end{figure}
Low T, Big L: MCMC too short to flip boundary
\end{frame}

\begin{frame}{Results}
%TODO inserire tabella risultati con chi^2
\begin{table}[!htb]
\centering
\begin{tabular}{|c|c|}
\hline
$\beta$ & $\sigma$\\
\hline
0.223 &  $(2.226 \pm 0.005) \cdot 10^{-3}$ \\
\hline
0.224 & $(4.637 \pm 0.006) \cdot 10^{-3} $\\
\hline
0.2255 & $(8.73 \pm 0.01)\cot 10^{-3}$\\
\hline
0.2275 & $(1.476 \pm 0.002\cdot 10^{-2})$\\
\hline
0.2327 & $(3.225 \pm 0.004)\cdot 10 ^{-2}$\\
\hline
0.2391 & $(5.60 \pm 0.01)cdot 10^{-2}$\\
\hline
\end{tabular}
\caption{Fit results for $\sigma$ \label{tab:fitsigma}}
\end{table}
\begin{center}
\begin{itemize}
\item Low statistical error
\item High systematics: unknown higher loop corrections
\item High $\chi ^2/\mbox{ndof}$
\end{itemize}
\end{center}
\end{frame}

\end{frame}

\begin{frame}{Fit of the critical behaviour}
\begin{center}
\begin{figure}
\centering
\includegraphics[scale=0.4]{sigmavsbeta.png}
\caption{Critical scaling law fit\label{fig:scalinglaw}}
\end{figure}

\end{center}
\end{frame}

\begin{frame}
\begin{center}
%la dovresti mettere prima del grafico sennò non si capisce
Scaling law at critical point:
\[
\sigma\left(\beta \right) = \sigma_0\left|\frac{\beta - \beta_c}{\beta_c} \right|^{\mu}
\]

\begin{table}[!htb]
\centering
\begin{tabular}{|c|c|c|}
\hline
$\sigma$ & $\mu$ & $\beta_c$\\
\hline
$1.209(6)$ & $1.202(2)$ & $0.22182(1)$\\
\hline
\end{tabular}
\caption{Fit results\label{tab:fitfinal}}
\end{table}

\begin{itemize}
\item correct critical exponent from Widom Law
\item High $\chi ^2$: points outside scaling region!
\item Consider modified scaling law $rightarrow$ low $\chi ^2$, no theoretical model.
\item changing fit law, $\sigma_0$ lies in 1.1 - 1.4 range.
\item high systematics!
\end{itemize}
\end{center}
\end{frame}

\begin{frame}{(Conclusions?)}
\begin{center}
\begin{figure}
\centering
\includegraphics[scale=0.4]{tableauthors.png}
\caption{Previous results for $\sigma_0$ in 3D Ising\label{fig:authors}}
\end{figure}
\begin{itemize}
\item Our result for $\sigma_0$ agrees but is in low end
\item We should factor in scaling breaking terms in the fit
\item No theoretical formula: cumbersome RG flow calculations
\end{itemize}
\end{center}
\end{frame}

%----------------------------------------------------------------------------------------

\end{document} 
